using VulnerabilityScanner.ApiAuthorization.Helpers;
using VulnerabilityScanner.ApiAuthorization.Models;

namespace VulnerabilityScanner.ApiAuthorization;

public class Program
{
    public static void Main(string[] args)
    {
        string folderPath = UIHelper.AskUserForValidFolderPath();
        
        List<ApiController> controllers = Scanner.ScanForControllers(folderPath);
        Scanner.ScanControllersForAuthorizationUsingSyntaxTree(controllers);

        Presenter.PresentResult(controllers, true);
        // Presenter.PresentResultAsMarkDownTable(controllers);
        
        Console.WriteLine();
        Presenter.PresentStats(controllers);
        
        Console.ReadKey();
    }
}